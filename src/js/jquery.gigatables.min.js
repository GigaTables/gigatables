!function($){String.prototype.trim||(String.prototype.trim=function(){return this.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")}),$.fn.GigaTable=function(options){function triggerCustomFunc(e,t,s){for(var o in e)s&&e[o].extended===t&&typeof e[o].triggerBefore===FUNCTION?e[o].triggerBefore():s||e[o].extended!==t||typeof e[o].triggerAfter!==FUNCTION||e[o].triggerAfter()}function setButtons(settings){var buttons=settings.tableOpts.buttons.sort(function(e,t){return t.extended.localeCompare(e.extended)}),btnsCnt=settings.tableOpts.buttons.length,editorObj=buttons[0].editor;if(typeof buttons!==UNDEFINED&&btnsCnt>0){var button=null;for(var k in buttons)button=buttons[k].editor.buttons[buttons[k].extended],$.inArray("top",settings.tableOpts.buttonsPosition)>=0&&settings.headTools.prepend('<div class="gte_buttons_container">'+button.replace("gte.button."+buttons[k].extended,eval("language."+buttons[k].extended))+'<div class="clear"></div></div>'),$.inArray("bottom",settings.tableOpts.buttonsPosition)>=0&&settings.footTools.prepend('<div class="gte_buttons_container">'+button.replace("gte.button."+buttons[k].extended,eval("language."+buttons[k].extended))+'<div class="clear"></div></div>');settings.headTools.find(".gte_button.create").click(function(){triggerCustomFunc(buttons,"editor_create",1),editorObj.triggerPopupCreate(settings);var e=settings.container.find(".gte_editor_popup");e.find(".gte_editor_title").text(language.gte_editor_popupheader_create),e.find("#gte_sent_btn").text(language.gte_editor_sendbtn_create),triggerCustomFunc(buttons,"editor_create",0)}),settings.footTools.find(".gte_button.create").click(function(){triggerCustomFunc(buttons,"editor_create",1),editorObj.triggerPopupCreate(settings);var e=settings.container.find(".gte_editor_popup");e.find(".gte_editor_title").text(language.gte_editor_popupheader_create),e.find("#gte_sent_btn").text(language.gte_editor_sendbtn_create),triggerCustomFunc(buttons,"editor_create",0)})}}function setSort(settings,json){var ths=settings.container.find("th"),i=0,c=ths.length/2;ths.each(function(){var that=$(this),idx=that.index();settings.columns[idx].sortable!==!1&&(settings.columns[idx].discreteSearch!==!0||settings.columns[idx].discreteSearch===!0&&c>i)&&that.click(function(){sortTimeout=setTimeout(function(){var objTh=that,idx=objTh.index(),nJson=json,cols=settings.columns,sortingOrder=0;objTh.hasClass("sorting")||objTh.hasClass("sorting_desc")?(ths.eq(idx).removeClass("sorting").removeClass("sorting_desc").addClass("sorting_asc"),ths.eq(idx+cols.length).removeClass("sorting").removeClass("sorting_desc").addClass("sorting_asc"),sortingOrder=1):(sortingOrder=-1,ths.eq(idx).removeClass("sorting_asc").addClass("sorting_desc"),ths.eq(idx+cols.length).removeClass("sorting_asc").addClass("sorting_desc"));var isNan=0,check=0;1===sortingOrder?nJson.sort(function(a,b){return a=eval("a."+cols[idx].data)+"",b=eval("b."+cols[idx].data)+"",0===check&&(isNaN(a-b)&&(isNan=1),check=1),isNan?a.localeCompare(b):a-b}):nJson.sort(function(a,b){return a=eval("a."+cols[idx].data)+"",b=eval("b."+cols[idx].data)+"",0===check&&(isNaN(a-b)&&(isNan=1),check=1),isNan?b.localeCompare(a):b-a}),setTableSort(settings,nJson)},50)}),++i})}function setSearch(e,t){var s=!1,o=[],i=0;e.container.find(".gt_search").keyup(function(){var a=$(this),n=a.val(),r=n.length;nowMillis=(new Date).getTime();var d=nowMillis-lastTimeKeyup;if(r>0||0===r&&""===n){if(s===!0&&""===n)return;if(s===!1&&""===n)return setTableRows(e,t),void(s=!0);var c=[],l="",g=0;for(var u in t)for(var _ in t[u])if("GT_RowId"!==_&&unsearchableCols[_]===!0&&(l=t[u][_]+"",-1!==l.indexOf(n))){c[g]=t[u],++g;break}if(d>PERIOD_SEARCH){for(var p in o)clearTimeout(o[p]);o=[],i=0,setTableRows(e,t,c)}else o[i]=setTimeout(function(){setTableRows(e,t,c)},TIMEOUT_SEARCH),i++;s=!1}lastTimeKeyup=nowMillis})}function setDiscreteSearch(e,t){var s=!1,o=[],i=0;e.tfoot.find("th input").keyup(function(){var a=$(this),n=a.val(),r=n.length,d=a.parent().index();nowMillisDiscrete=(new Date).getTime();var c=nowMillisDiscrete-lastTimeKeyupDiscrete;if(c>PERIOD_SEARCH&&r>0||0===r&&""===n){if(s===!0&&""===n)return;if(s===!1&&""===n)return setTableRows(e,t),void(s=!0);var l=[],g="",u=0;for(var _ in t)for(var p in t[_])if("GT_RowId"!==p&&unsearchableCols[p]===!0&&e.columns[d].data===p&&(g=t[_][p]+"",-1!==g.indexOf(n))){l[u]=t[_],++u;break}if(c>PERIOD_SEARCH){for(var h in o)clearTimeout(o[h]);o=[],i=0,setTableRows(e,t,l)}else o[i]=setTimeout(function(){setTableRows(e,t,l)},TIMEOUT_SEARCH),i++;s=!1}lastTimeKeyupDiscrete=nowMillisDiscrete})}function setPgnSelect(e,t){if(typeof e.headTools!==UNDEFINED){var s=e.container.find(".gt_select");s.change(function(){settings.defaultPerPage=$(this).val(),settings.fromRow=0,setTableRows(settings,t),s.find("option").prop(SELECTED,!1),s.find('option[value="'+settings.defaultPerPage+'"]').prop(SELECTED,!0)})}}function drawPagnButtons(e,t,s){for(var o=5,i="",a="",n=0,r=0,d=0,c=t/s+1,l=parseInt(e)-o,g=0;e>g;++g){n=g*s;var u=g-1,_=g+1;if(c===_&&(r=u*s,0>u&&(r=(e-1)*s),d=_*s,_===e&&(d=0)),g>o){if(o>c){i+='<div class="gt_page_dots">...</div>',g+1===e&&(a=SELECTED),i+='<div data-from="'+(e-1)*s+'" class="gt_page '+a+'">'+e+"</div>";break}if(c>=o&&e-o>=c){u=c-1,_=c+1,i='<div data-from="0" class="gt_page">1</div>',i+='<div class="gt_page_dots">...</div>',r=(c-2)*s,d=c*s,i+='<div data-from="'+r+'" class="gt_page">'+(c-1)+"</div>",i+='<div data-from="'+(c-1)*s+'" class="gt_page selected">'+c+"</div>",i+='<div data-from="'+d+'" class="gt_page">'+(c+1)+"</div>",i+='<div class="gt_page_dots">...</div>',i+='<div data-from="'+(e-1)*s+'" class="gt_page">'+e+"</div>";break}if(c>l){i='<div data-from="0" class="gt_page">1</div>',i+='<div class="gt_page_dots">...</div>';for(var p=l-1;e>p;++p){var n=p*s,u=p-1,_=p+1;c===_&&(r=u*s,0>u&&(r=(e-1)*s),d=_*s,_===e&&(d=0),a=SELECTED),i+='<div data-from="'+n+'" class="gt_page '+a+'">'+(p+1)+"</div>",a=""}break}}else c===_&&(a=SELECTED),i+='<div data-from="'+n+'" class="gt_page '+a+'">'+_+"</div>";a=""}return'<div class="gt_pagn"><div data-from="'+r+'" class="gt_page prev">'+language.prev+"</div>"+i+'<div data-from="'+d+'" class="gt_page next">'+language.next+"</div></div>"}function setTableSort(e,t){var s="",o=t,i=parseInt(e.defaultPerPage)+parseInt(e.fromRow),i=0;i=o.length>e.defaultPerPage?parseInt(e.defaultPerPage)+parseInt(e.fromRow):o.length;var a=settings.tbody.find("tr.active"),n=[];typeof a!==UNDEFINED&&a.each(function(){var e=$(this).attr("gte-row-id");n[e]=e});for(var r=e.fromRow;i>r;++r){var d=0,c="";if(typeof o[r].GT_RowId!==UNDEFINED)d=o[r].GT_RowId;else{if(typeof o[r].id===UNDEFINED)return void console.error('You have neither "GT_RowId" nor "id" in json structure.');d=o[r].id}n.length>0&&typeof n[d]!==UNDEFINED&&(c="active"),s+='<tr class="'+c+'" gte-row-id="'+d+'">';var l=settings.columnOpts,g=e.columns;if(l.length>0){var u=0,_="";for(var p in g){var h=g[p].data;if("GT_RowId"!==h&&invisibleCols[h]===!0){_=o[r][h];for(var f in l)if(typeof l[f].render!==UNDEFINED&&l[f].target===u){var v={id:d},b="string";_=l[f].render(_,v,b)}s+='<td data-name="'+h+'">'+_+"</td>"}++u}}else for(var p in g){var h=g[p].data;"GT_RowId"!==h&&invisibleCols[h]===!0&&(s+='<td data-name="'+h+'">'+o[r][h]+"</td>")}s+="</tr>"}e.tbody.html(s),clearTimeout(sortTimeout),setSelectRows(e,1)}function setTableRows(e,t,s){var o="",i=t;typeof s!==UNDEFINED&&(i=s);var a=0;a=i.length>e.defaultPerPage?parseInt(e.defaultPerPage)+parseInt(e.fromRow):i.length;var n=settings.tbody.find("tr.active"),r=[];typeof n!==UNDEFINED&&n.each(function(){var e=$(this).attr("gte-row-id");r[e]=e});for(var d=e.fromRow;a-1>=d&&typeof i[d]!==UNDEFINED;d++){var c=0,l="";if(typeof i[d].GT_RowId!==UNDEFINED)c=i[d].GT_RowId;else{if(typeof i[d].id===UNDEFINED)return void console.error('You have neither "GT_RowId" nor "id" in json structure.');c=i[d].id}r.length>0&&typeof r[c]!==UNDEFINED&&(l="active"),o+='<tr class="'+l+'" gte-row-id="'+c+'">';var g=settings.columnOpts,u=e.columns;if(g.length>0){var _=0,p="";for(var h in u){var f=u[h].data;if("GT_RowId"!==f&&invisibleCols[f]===!0){p=i[d][f];for(var v in g)if(typeof g[v].render!==UNDEFINED&&g[v].target===_){var b={id:c},m="string";p=g[v].render(p,b,m)}o+='<td data-name="'+f+'">'+p+"</td>"}++_}}else for(var h in u){var f=u[h].data;"GT_RowId"!==f&&invisibleCols[f]===!0&&(o+='<td data-name="'+f+'">'+i[d][f]+"</td>")}o+="</tr>"}e.tbody.html(o),clearTimeout(searchTimeout),setSelectRows(e,0),setPagination(e,t),setPgnSelect(settings,t),0===searchSet&&(setSearch(settings,t),searchSet=1),0===discreteSearchSet&&(setDiscreteSearch(settings,t),discreteSearchSet=1)}function setEditBtn(e){var t=settings.tableOpts.buttons[0].editor,s=settings.tableOpts.buttons;e.removeClass("gte_btn_disabled"),e.off("click"),e.click(function(){triggerCustomFunc(s,"editor_edit",1),t.triggerPopupEdit(settings);var e=settings.container.find(".gte_editor_popup");e.find(".gte_editor_title").text(language.gte_editor_popupheader_edit),e.find("#gte_sent_btn").text(language.gte_editor_sendbtn_update),triggerCustomFunc(s,"editor_edit",0)})}function setDeleteBtn(e){var t=settings.tableOpts.buttons[0].editor,s=settings.tableOpts.buttons;e.removeClass("gte_btn_disabled"),e.off("click"),e.click(function(){triggerCustomFunc(s,"editor_remove",1),t.triggerPopupDelete(settings);var e=settings.container.find(".gte_editor_popup");e.find(".gte_editor_title").text(language.gte_editor_popupheader_delete),e.find("#gte_sent_btn").text(language.gte_editor_sendbtn_delete);var o="",i=0;settings.tbody.find("tr.active").each(function(){o+='<input type="hidden" name="ids[]" value="'+$(this).attr("gte-row-id")+'"/>',++i}),e.find("#gte_msg").html("Are You sure You wish to delete "+i+" rows?"),e.find("#gte_ids").html(o),triggerCustomFunc(s,"editor_remove",0)})}function unsetEditBtn(e){e.addClass("gte_btn_disabled"),e.off("click")}function unsetDeleteBtn(e){e.addClass("gte_btn_disabled"),e.off("click")}function setSelectRows(e,t){t?(e.tbody.children().removeClass("even").removeClass("odd"),e.tbody.children().off("click")):($(document).keydown(function(e){e.which===CNTRL_KEY&&(s=!0),e.which===SHIFT_KEY&&(o=!0)}),$(document).keyup(function(){s=!1,o=!1})),e.tbody.children(":even").addClass("even"),e.tbody.children(":odd").addClass("odd");var s=!1,o=!1;e.tbody.children().click(function(){var t=$(this),i=t.siblings();if(s===!1&&o===!1)t.hasClass("active")?t.removeClass("active"):(that.find("tbody tr.active").removeClass("active"),t.addClass("active"));else if(s)t.hasClass("active")?t.removeClass("active"):t.addClass("active");else if(o){var a=t.siblings(".active:first"),n=t.siblings(".active:last"),r=a.index(),d=n.index(),c=t.index();if(t.addClass("active"),d===r)d>c?i.each(function(){var e=$(this),t=e.index();t>c&&d>t&&e.addClass("active")}):i.each(function(){var e=$(this),t=e.index();c>t&&t>d&&e.addClass("active")});else{var l=Math.abs(c-r),g=Math.abs(c-d);g>=l?i.each(function(){var e=$(this),t=e.index();c>t&&t>r&&e.addClass("active")}):i.each(function(){var e=$(this),t=e.index();t>c&&d>t&&e.addClass("active")})}}var u=t.hasClass("active")?1:0;i.each(function(){$(this).hasClass("active")&&++u});var _=e.container.find(".gte_button.edit"),p=e.container.find(".gte_button.remove");1===u?(setEditBtn(_),setDeleteBtn(p)):(unsetEditBtn(_),0===u?unsetDeleteBtn(p):setDeleteBtn(p))})}function setPagination(e,t){if(e.struct.pagination.length>0){var s=e.container.find(".gt_pagination"),o=t.length,i=parseInt(e.defaultPerPage),a=Math.ceil(o/i),n=e.fromRow?parseInt(e.fromRow):0,r=drawPagnButtons(a,n,i,s);s.remove();var d='<div class="gt_pagination"><div class="gt_pgn_ttl">'+language.showing+" "+(n+1)+" "+language.to+" "+(n+i)+" "+language.of+" "+o+" "+language.entries+'. </div><div class="gt_pgn_pages">'+r+'</div><div class="clear"></div></div>';-1!==e.struct.pagination.indexOf("top")&&e.headTools.after(d),-1!==e.struct.pagination.indexOf("bottom")&&e.footTools.before(d),e.container.find(".gt_page").click(function(){var s=$(this);e.fromRow=parseInt(s.attr("data-from")),setTableRows(e,t)})}}var PERIOD_SEARCH=200,TIMEOUT_SEARCH=300,SORT_ASC="asc",SORT_DESC="desc",POSITION_TOP="top",POSITION_BOTTOM="bottom",UNDEFINED="undefined",FUNCTION="function",SELECTED="selected",CHECKED="checked",CNTRL_KEY=17,SHIFT_KEY=16,ENTER_KEY=13,that=this,json=null,struct={},language=[],invisibleCols=[],unsearchableCols=[],searchSet=0,discreteSearchSet=0,sortTimeout=null,searchTimeout=null,lastTimeKeyup=(new Date).getTime(),nowMillis=0,lastTimeKeyupDiscrete=(new Date).getTime(),nowMillisDiscrete=0;struct.search=[],typeof options.struct.search===UNDEFINED?struct.search=[POSITION_TOP]:options.struct.search.length>0&&(struct.search=options.struct.search),struct.rowsSelector=[],typeof options.struct.rowsSelector===UNDEFINED?struct.rowsSelector=[SORT_ASC,POSITION_TOP,POSITION_BOTTOM]:options.struct.rowsSelector.length>0&&(struct.rowsSelector=options.struct.rowsSelector),struct.pagination=[],typeof options.struct.pagination===UNDEFINED?struct.pagination=["bottom"]:options.struct.pagination.length>0&&(struct.pagination=options.struct.pagination);var langs={en:{gte_editor_popupheader_delete:"Delete",gte_editor_popupheader_edit:"Edit",gte_editor_popupheader_create:"Create row",gte_editor_sendbtn_create:"Create",gte_editor_sendbtn_update:"Update",gte_editor_sendbtn_delete:"Delete",show:"Show",entries:"entries",showing:"Showing",to:"to",of:"of",prev:"Previous",next:"Next",search:"Search",editor_create:"New",editor_edit:"Edit",editor_remove:"Delete"},gr:{gte_editor_popupheader_delete:"Löschen",gte_editor_popupheader_edit:"Bearbeiten",gte_editor_popupheader_create:"Neu zeile",gte_editor_sendbtn_create:"",gte_editor_sendbtn_update:"",gte_editor_sendbtn_delete:"",show:"Zeigen",entries:"einträge",showing:"Zeigen",to:"bis",of:"von",prev:"früher",next:"Nächste",search:"Suche",editor_create:"Neu",editor_edit:"Bearbeiten",editor_remove:"Löschen"},ru:{gte_editor_popupheader_delete:"Удалить",gte_editor_popupheader_edit:"Редактировать",gte_editor_popupheader_create:"Создать строку",gte_editor_sendbtn_create:"Создать",gte_editor_sendbtn_update:"Сохранить",gte_editor_sendbtn_delete:"Удвлить",show:"Показать",entries:"строк",showing:"Показано от",to:"до",of:"из",prev:"Пред.",next:"След.",search:"Поиск",editor_create:"Создать",editor_edit:"Редактировать",editor_remove:"Удалить"},fr:{gte_editor_popupheader_delete:"Effacer",gte_editor_popupheader_edit:"éditer",gte_editor_popupheader_create:"Créer rangée",gte_editor_sendbtn_create:"",gte_editor_sendbtn_update:"",gte_editor_sendbtn_delete:"",show:"Montrer",entries:"entrées",showing:"Projection",to:"à",of:"de",prev:"Précédent",next:"Suivant",search:"Recherche",editor_create:"Créer",editor_edit:"éditer",editor_remove:"Effacer"},es:{gte_editor_popupheader_delete:"Borrar",gte_editor_popupheader_edit:"Editar",gte_editor_popupheader_create:"Crear fila",gte_editor_sendbtn_create:"",gte_editor_sendbtn_update:"",gte_editor_sendbtn_delete:"",show:"Mostrar",entries:"Entradas",showing:"Demostración",to:"a",of:"de",prev:"Anterior",next:"Próximo",search:"Buscar",editor_create:"Crear",editor_edit:"Editar",editor_remove:"Borrar"},ch:{gte_editor_popupheader_delete:"删除",gte_editor_popupheader_edit:"编辑",gte_editor_popupheader_create:"创建行",gte_editor_sendbtn_create:"",gte_editor_sendbtn_update:"",gte_editor_sendbtn_delete:"",show:"显示",entries:"项目",showing:"显示",to:"至",of:"的",prev:"前",next:"未来",search:"搜索",editor_create:"创造",editor_edit:"编辑",editor_remove:"删除"},hi:{gte_editor_popupheader_delete:"हटाना",gte_editor_popupheader_edit:"संपादन करना",gte_editor_popupheader_create:"पंक्ति बना",gte_editor_sendbtn_create:"",gte_editor_sendbtn_update:"",gte_editor_sendbtn_delete:"",show:"प्रदर्शन",entries:"आइटम",showing:"नुमाइश",to:"तक",of:"की",prev:"पूर्व",next:"अगला",search:"खोज",editor_create:"बनाना",editor_edit:"संपादन करना",editor_remove:"हटाना"}},settings=$.extend(!0,{styling:{color:"#333",bgColor:"#ccc",highlightColor:"orange"},struct:struct,lang:"en",requestType:"GET",perPageRows:[25,50,100,200,500],defaultPerPage:25,columns:[],columnOpts:[],tableOpts:{buttons:[],theme:"std"}},options);switch(settings.setSelectedRows=setSelectRows,settings.lang){case"gr":language=langs.gr;break;case"ru":language=langs.ru;break;case"fr":language=langs.fr;break;case"hi":language=langs.hi;break;case"ch":language=langs.ch;break;case"es":language=langs.es;break;default:language=langs.en}var thead=that.children(":first"),tfoot=that.children(":last"),headThs=thead.children().children(),footThs=tfoot.children().children(),cntCols=headThs.length;that.wrap('<div class="gt_container"></div>');var container=that.parent().parent().find(".gt_container").prepend('<div class="gt_head_tools"></div>'),headTools=that.parent().parent().find(".gt_head_tools");container.append('<div class="gt_foot_tools"></div>');var footTools=container.find(".gt_foot_tools");if(settings.struct.rowsSelector.length>0){var options=language.show+' <select class="gt_select" name="per_page_rows">';for(var k in settings.perPageRows){var rows=settings.perPageRows[k];options+="<option "+(settings.defaultPerPage===rows?'selected=""':"")+' value="'+rows+'">'+rows+"</option>"}options+="</select> "+language.entries,-1!==settings.struct.rowsSelector.indexOf("top")&&headTools.append('<div class="gt_rows_selector">'+options+"</div>"),-1!==settings.struct.rowsSelector.indexOf("bottom")&&footTools.append('<div class="gt_rows_selector">'+options+"</div>")}return settings.struct.search.length>0&&headTools.append('<div class="gt_main_search"><input type="text" class="gt_search" value="" placeholder="'+language.search+'" /></div>'),headTools.append('<div class="clear"></div>'),footTools.append('<div class="clear"></div>'),that.addClass("gigatable"),thead.addClass("gt_head"),tfoot.addClass("gt_foot"),thead.after('<tbody class="gt_body"><tr><td class="gt_loader" colspan="'+cntCols+'">Loading...</td></tr></tbody>'),settings.thead=thead,settings.tbody=thead.next(),settings.tfoot=tfoot,settings.headThs=headThs,settings.cntCols=cntCols,settings.headTools=headTools,settings.footTools=footTools,settings.container=container,settings.fromRow=0,$.ajax({url:settings.ajax,type:settings.requestType,dataType:"json"}).done(function(e){if(json=e.rows?e.rows:e.row,typeof json===UNDEFINED)return console.error("Put json into rows or row associative key!"),!1;var t=container.find("th");t.each(function(){var e=$(this),t=e.index();settings.columns[t].sortable!==!1&&e.addClass("sorting"),settings.columns[t].visible===!1?(e.hide(),invisibleCols[settings.columns[t].data]=!1):invisibleCols[settings.columns[t].data]=!0,settings.columns[t].searchable===!1?unsearchableCols[settings.columns[t].data]=!1:unsearchableCols[settings.columns[t].data]=!0}),tfoot.find("th").each(function(){var e=$(this),t=e.index();if(settings.columns[t].discreteSearch===!0){var s="Search in "+e.text();typeof settings.columns[t].discreteSearchValue!==UNDEFINED&&(s=settings.columns[t].discreteSearchValue(e.text()),e.removeClass("sorting")),e.html('<input type="text" placeholder="'+s+'" />')}}),setTableRows(settings,json),setSort(settings,json),settings.tableOpts.buttons.length>0&&setButtons(settings);var s=that.width();container.css("width",s+40+"px")}),this}}(jQuery);